{% extends "base.html" %}
{% block content %}
<h1 style="text-align: center;">ðŸ“Š EstadÃ­sticas de Clientes</h1>

<form method="get" style="text-align: center; margin-bottom: 20px;">
    <label for="{{ form.fecha_desde.id_for_label }}">Desde:</label>
    {{ form.fecha_desde }}
    
    <label for="{{ form.fecha_hasta.id_for_label }}">Hasta:</label>
    {{ form.fecha_hasta }}
    {% for error in form.fecha_hasta.errors %}
        <p class="alert alert-danger text-center">{{ error }}</p>
    {% endfor %}
    {% for error in form.fecha_desde.errors %}
        <p class="alert alert-danger text-center">{{ error }}</p>
    {% endfor %}

    <button type="submit" class="boton-VolverAlInicio">Generar grÃ¡fico</button>
</form>
       
{% if etiquetas %}
    <div style="width: 80%; margin: 0 auto;">
        <canvas id="graficoClientes"></canvas>
    </div>
{% else %}
    <p style="text-align: center;">No hay datos para el rango seleccionado.</p>
{% endif %}

<a href="{% url 'ver_clientes' %}">
    <button class="boton-VolverAlInicio">Volver al listado</button>
</a>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('graficoClientes');
    const chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: {{ etiquetas|safe }},
            datasets: [
                {
                    label: 'Habilitados',
                    data: {{ habilitados|safe }},
                    backgroundColor: 'rgba(38, 207, 61, 0.7)'
                },
                {
                    label: 'Inhabilitados',
                    data: {{ inhabilitados|safe }},
                    backgroundColor: 'rgba(239, 83, 80, 0.7)'
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>

{% endblock %}